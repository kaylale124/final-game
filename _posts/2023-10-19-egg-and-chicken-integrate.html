---
comments: false
layout: default
title: Egg + Chicken Integrate
type: hacks
courses: { compsci: {week: 7} }
---

<!-- Liquid code, run by Jekyll, used to define location of asset(s) -->
{% assign backgroundFile = site.baseurl | append: page.image %}

<style>
    #placeholder {
        width: 100%;
    }
    canvas {
        position: absolute;
        top: 60px;
        bottom: 205px;
        left: 0;
        width: 100%;
    }
</style>

<!-- Prepare DOM elements -->
<div id="canvasContainer">
    <canvas id="backgroundID">
        <img id="backgroundImage" src="{{backgroundFile}}">
    </canvas>
</div>


<div id="placeholder"></div>

<script>
    // Prepare Background Image
    const backgroundImg = new Image();
    backgroundImg.src = '{{backgroundFile}}';  // Jekyll/Liquid puts filename here
    
    
    // Prepare Window extents related to viewport
    const maxWidth = window.innerWidth;
    const maxHeight = window.innerHeight;

    // Account for the header height
    const headerHeight = document.querySelector('header').offsetHeight;

    // Calculate the top position
    const topPosition = headerHeight + ((maxHeight - headerHeight) / 2);

    // Prepare placeholder element
    const placeholder = document.getElementById('placeholder');
    
backgroundImg.onload = function () {
    // Setup background constants from background image
    const WIDTH = backgroundImg.width;  // Image() width (meta data)
    const HEIGHT = backgroundImg.height; // Image() height
    const ASPECT_RATIO = WIDTH / HEIGHT;
    const ADJUST = 1.42; // visual layer adjust, use “1” for a perfect loop   
         
    // Set Dimensions to match the image width
    const canvasWidth = maxWidth;
    const canvasHeight = canvasWidth / ASPECT_RATIO;  // height is oriented by width
    const canvasLeft = 0;
    const canvasTop = 60;
    
    // Set dimensions for the background canvas
    canvas.width = WIDTH / ADJUST;
    canvas.height = HEIGHT / ADJUST;

    // Set Style properties for the background canvas
    canvas.style.width = `${canvasWidth}px`;
    canvas.style.height = `${canvasHeight}px`;
    canvas.style.position = 'absolute';
    canvas.style.left = `${canvasLeft}px`;
    canvas.style.top = `${canvasTop}px`;
    
    // Game speed is a common game variable
    var gameSpeed = 2;
    
    // Layer is set up to support Parallax, multiple layers
    class Layer {
        constructor(image, speedRatio) {
            this.x = 0;
            this.y = 0;
            this.width = WIDTH;
            this.height = HEIGHT;
            this.image = image;
            this.speedRatio = speedRatio;
            this.speed = gameSpeed * this.speedRatio;
            this.frame = 0;
        }
        update() {
            this.x = (this.x - this.speed) % this.width;
        }
        draw() {
            ctx.drawImage(backgroundImg, 0, 0, canvas.width, canvas.height);
        }
            
    }
        
    
    // Background object
    var backgroundObj = new Layer(backgroundImg, 0.2);
    
    // Animation loop
    function animation() {
        backgroundObj.draw();
    
        requestAnimationFrame(animation);  // cycle animation, recursion
    }
    
    // Start animation process
    animation();
    
    //Invert the colors
    var isFilterEnabled = true;
    const defaultFilter = getComputedStyle(document.documentElement).getPropertyValue('--default-canvas-filter');
    if (isFilterEnabled) {
        canvas.style.filter = "none";  // remove filter
    } else {
        canvas.style.filter = defaultFilter; // Apply the default filter value
    }
}
    
let HEIGHT = backgroundImg.height;

function placeholderAdjust() {
    placeholder.style.height = HEIGHT + px;
}
    
// Call the function initially and on window resize
backgroundImg.addEventListener('load', function () {
    placeholderAdjust();
});

document.getElementById('startButton').addEventListener('click', function() {
    var mainScreen = document.getElementById("mainScreen");
    mainScreen.remove();
    var startScreen = document.getElementById('startScreen');
    startScreen.classList.remove('hidden');
});

</script>

{% assign backgroundFile = site.baseurl | append: page.image %}

{% assign spriteFile = site.baseurl | append: page.sprite %}

<style>
    #placeholder {
        width: 100%;
    }
    canvas {
        position: absolute;
        top: 60px;
        bottom: 205px;
        left: 0;
        width: 100%;
    }
</style>
<div id="placeholder"></div>

<canvas id="gameCanvas></canvas>
<div id="canvasContainer">
    <div id="controls"> <!-- Controls -->
        <button id="toggleCanvasEffect">Invert</button>
    </div>
</div>
<script>


    const image = new Image();
    image.src = '{{ spriteFile }}';

    canvas.width = 600;
    canvas.height = 450;

    // Define the Player class
    class Player {
        constructor() {
            // Initial position and velocity of the player
            this.position = {
                x: 300,
                y: 300
            };

            this.rotation = 0;

            this.speed = 5; // Adjust the speed as needed
            // Dimensions of the player
            this.width = 45;
            this.height = 45;
        }
        // Method to draw the player on the canvas using the chicken image
        draw() {

            ctx.save();
            ctx.translate(
                player.position.x + player.width /2,
                player.position.y + player.height /2
            );

            ctx.rotate(this.rotation);

            ctx.translate(
                -player.position.x - player.width /2,
                -player.position.y - player.height /2

            )

            ctx.clearRect(0, 0, canvas.width, canvas.height); // Clear the canvas
            ctx.drawImage(image, this.position.x, this.position.y, this.width, this.height);

            ctx.restore();
        }
    }

    // Animation function to continuously update and render the canvas
    function animate() {
        requestAnimationFrame(animate);
        player.draw();

        // Update player position based on key states
        if (keys.right.pressed && player.position.x + player.width <= canvas.width - player.speed) {
            player.position.x += player.speed;
            player.rotation = 0.15;
        }
        else if (keys.left.pressed && player.position.x >= player.speed) {
            player.position.x -= player.speed;
            player.rotation = -0.15;
        } else {
            player.rotation = 0;
        };
    }

    animate();

    // Event listener for keydown events
    addEventListener('keydown', ({ keyCode }) => {
        switch (keyCode) {
            case 65:
                keys.left.pressed = true;
                break;
            case 83:
                keys.down.pressed = true;
                break;
            case 68:
                keys.right.pressed = true;
                break;
            case 87:
                keys.up.pressed = true;
                break;
        }
    });

    // Event listener for keyup events
    addEventListener('keyup', ({ keyCode }) => {
        switch (keyCode) {
            case 65:
                keys.left.pressed = false;
                break;
            case 83:
                keys.down.pressed = false;
                break;
            case 68:
                keys.right.pressed = false;
                break;
            case 87:
                keys.up.pressed = false;
                break;
        }
    });

    function toggleCanvasEffect() {
        const canvasFilter = canvas.style.filter;
        if (canvasFilter.includes("invert")) {
            // If the filter already contains invert, remove it
            canvas.style.filter = "none";
        } else {
            // Otherwise, add invert to the filter
            canvas.style.filter = "invert(100%)";
        }
    };

    document.getElementById("toggleCanvasEffect").addEventListener("click", toggleCanvasEffect);

</script>

<div id="canvasContainer">
    <canvas id="backgroundID">
        <img id="backgroundImage" src="{{backgroundFile}}">
    </canvas>
</div>


<div id="placeholder"></div>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Armeneggon Sample</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
        }
        canvas {
            display: block;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="600" height="400"></canvas>

    <script>
        class Player {
            constructor(canvas, ctx) {
                this.canvas = canvas;
                this.ctx = ctx;
                this.x = canvas.width / 2;
                this.y = canvas.height - 30;
                this.width = 30;
                this.height = 30;
                this.color = '#FFFDE3';
                this.speed = 5; // Adjusted speed
            }

            move(direction) {
                if (direction === 'left') {
                    this.x -= this.speed;
                } else if (direction === 'right') {
                    this.x += this.speed;
                }
            }

            draw() {
                this.ctx.fillStyle = this.color;
                this.ctx.fillRect(this.x - this.width / 2, this.y - this.height / 2, this.width, this.height);
            }
        }

        class Projectile {
            constructor(canvas, ctx, x, y, speed, image) {
                this.canvas = canvas;
                this.ctx = ctx;
                this.x = x;
                this.y = y;
                this.speed = speed;
                this.image = image;
            }

            move() {
                this.y -= this.speed;
            }

            draw() {
                this.ctx.drawImage(this.image, this.x, this.y);
            }
        }

        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        let projectiles = [];

        const projectileImage = new Image();
        projectileImage.src = "{{site.baseurl}}/images/egg-projectile.png";

        const player = new Player(canvas, ctx);

        document.addEventListener('keydown', keyDownHandler);

        function keyDownHandler(e) {
            if (e.key === 'a' || e.key === 'A') {
                player.move('left');
            } else if (e.key === 'd' || e.key === 'D') {
                player.move('right');
            } else if (e.key === ' ' || e.code === 'Space') {
                const projectile = new Projectile(canvas, ctx, player.x - 25, player.y, 3, projectileImage);
                projectiles.push(projectile);
            }
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            player.draw();

            for (let i = projectiles.length - 1; i >= 0; i--) {
                projectiles[i].move();
                projectiles[i].draw();

                if (projectiles[i].y < 0) {
                    projectiles.splice(i, 1);
                }
            }

            requestAnimationFrame(draw);
        }

        draw();
    </script>
</body>
</html> 
